---
title: "Analise de Cr√f∆'√,¬©dito - Machine Learning"
author: "Michel H S Nascimento"
date: "2 de fevereiro de 2018"
output:
  word_document: default
  pdf_document: default
  html_document: default
---


## Conhecendo os dados

Este documento trata de um estudo sobre machine learning, atrav√©s da execu√ß√£o de exerc√≠cios de um curso de ML da Udemy que visa analisar a disponibilidade de cr√©dito das pessoas atrav√©s de um conjunto de dados.

A biblioteca usada para o algoritmo de ML foi a "e1071".

```{r includes}
#install.packages("e1071")
library(e1071)
```

Importando os dados de cr√©ditos:

```{r import}
dados_creditos = read.csv(file.choose())

head(dados_creditos)
```

Pode perceber no conjunto de dados as caracter√≠sticas de todas as int√¢ncias na massa de dados, onde seu atributo final referente a classe descreve se tal inst√¢ncia √© tido como um bom ou mal pagador.

## Criando Amostras

Para uma an√°lise mais adequada de resultados para posteriormente coloc√°-los em produ√ß√£o com uma certa confian√ßa, se faz necess√°rio a divis√£o dos dados em amostras para testes e para treino:

```{r testeetreino}
amostras = sample(2, 1000, replace = T, prob = c(0.7,0.3))
amostras
dados_treino = dados_creditos[amostras==1,]
dados_teste = dados_creditos[amostras==2,]
```

## Cria√ß√£o do Modelo

Cria-se o modelo para an√°lise dos dados, este √© feito com base na fun√ß√£o da biblioteca que foi carregada, neste caso naivebayes; Tal modelo permite identificar rela√ß√µes de proporcionalidade entre os atributos definidos na massa de dados:

```{r modelo}
modelo = naiveBayes(class ~., dados_treino)
modelo
```
## Previs√£o
Usa-se o modelo obtido para a an√°lise preditiva sobre a parcela de dados reservadas para o teste, assim os valores podem ser confrontados de modo que se possa verificar a confian√ßa do modelo:

```{r previs√£o}
previsao = predict(modelo, dados_teste)
previsao
```

Matriz Confus√£o


```{r confusao}
matriz_confusao = table(dados_teste$class, previsao)
matriz_confusao

#taxa de acerto
taxa = (matriz_confusao[1]+matriz_confusao[4])/sum(matriz_confusao)
taxa
```
## Deployment

Faz-se a an√°lise a partir de um arquivo externo de poss√≠veis novas buscas por cr√©dito com o modelo produzido:

```{r deplyment}
novos_dados = read.csv(file.choose())
previsao_deployment = predict(modelo, novos_dados)
previsao_deployment
```

## An·lise de Atributos

```{r atributos}
library(e1071)
# Verificando o nÌvel de confianÁa do modelo sem alterar n˙mero de atributos
modelo_svm = svm(class ~., dados_treino)

previsao_svm = predict(modelo_svm, dados_teste)

m_confusao_svm = table(dados_teste$class, previsao_svm)

taxa_good = (m_confusao_svm[1] + m_confusao_svm[4])/sum(m_confusao_svm)

library(FSelector)

random.forest.importance(class ~., dados_creditos)

modelo_atributos = svm(class ~ checking_status + duration + credit_history, dados_treino)

previsao_atributos = predict(modelo_atributos, dados_teste)

m_confusao_svm_att = table(dados_teste$class, previsao_atributos)

taxa_good_att = (m_confusao_svm_att[1] + m_confusao_svm_att[4])/sum(m_confusao_svm_att)


```